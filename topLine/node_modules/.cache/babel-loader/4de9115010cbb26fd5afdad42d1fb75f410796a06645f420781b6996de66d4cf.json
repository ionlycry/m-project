{"ast":null,"code":"import \"core-js/modules/es.array.unshift.js\";\nimport SearchHistory from './components/SearchHistory.vue';\nimport SearchResult from './components/SearchResult.vue';\nimport SearchSuggestion from './components/SearchSuggestion.vue';\nimport { setItem, getItem } from '@/utils/storage';\nexport default {\n  data() {\n    return {\n      value: '',\n      isShowResult: false,\n      searchHistories: getItem('TOUTIAO_SEARCH_HISTORIES') || []\n    };\n  },\n  components: {\n    SearchHistory,\n    SearchResult,\n    SearchSuggestion\n  },\n  methods: {\n    onCancel() {\n      // this.$router.back()\n      console.log('取消');\n    },\n    onSearch(val) {\n      console.log(val);\n      // 更新文本框内容\n      this.value = val;\n      // 存储历史记录，不能有重复记录，最新的排在最前面\n      // array.indexof（val）,如果找到即！== -1，则移除对应项\n      // array.unshift\n      const index = this.searchHistories.indexOf(val);\n      if (index !== -1) {\n        // 有重复值\n        // splice删除\n        this.searchHistories.splice(index, 1);\n      }\n      // 向前插入值\n      this.searchHistories.unshift(val);\n      // 渲染搜索结果\n      this.isShowResult = true;\n    }\n  },\n  watch: {\n    searchHistories(val) {\n      // 最新的数组传入\n      setItem('TOUTIAO_SEARCH_HISTORIES', val);\n    }\n  }\n};","map":{"version":3,"mappings":";AAiCA;AACA;AACA;AACA;AACA;EACAA;IACA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;IACAC;IACAC;EACA;EACAC;IACAC;MACA;MACAC;IACA;IACAC;MACAD;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;MACA;MACA;MACA;MACA;MACA;IACA;EACA;EACAE;IACAT;MACA;MACAU;IACA;EACA;AACA","names":["data","value","isShowResult","searchHistories","components","SearchHistory","SearchResult","SearchSuggestion","methods","onCancel","console","onSearch","watch","setItem"],"sourceRoot":"src/views/Search","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div class=\"search-container\">\r\n    <!-- 顶部输入框 -->\r\n    <form action=\"/\">\r\n      <van-search\r\n        v-model=\"value\"\r\n        show-action\r\n        placeholder=\"请输入搜索关键词\"\r\n        background=\"#3296fa\"\r\n        @cancel=\"onCancel\"\r\n        @search=\"onSearch\"\r\n        class=\"serach-form\"\r\n        clearable>\r\n      </van-search>\r\n    </form>\r\n    <!-- 逻辑：是否显示搜索结果，默认不显示，如果不显示搜索结果，判断是否有搜索值，没有搜索值，就显示历史记录 -->\r\n    <!-- 搜索结果 -->\r\n    <SearchResult v-if=\"isShowResult\" :inputVal=\"value\"></SearchResult>\r\n    <!-- 搜索建议 -->\r\n    <SearchSuggestion\r\n      :inputVal=\"value\"\r\n      v-else-if=\"value\"\r\n      @search=\"onSearch\"></SearchSuggestion>\r\n    <!-- 搜索历史 -->\r\n    <SearchHistory\r\n      v-else\r\n      :searchHistoryArr=\"searchHistories\"\r\n      @delSearchHistory=\"searchHistories = []\"\r\n      @search=\"onSearch\"></SearchHistory>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SearchHistory from './components/SearchHistory.vue'\r\nimport SearchResult from './components/SearchResult.vue'\r\nimport SearchSuggestion from './components/SearchSuggestion.vue'\r\nimport { setItem, getItem } from '@/utils/storage'\r\nexport default {\r\n  data() {\r\n    return {\r\n      value: '',\r\n      isShowResult: false,\r\n      searchHistories: getItem('TOUTIAO_SEARCH_HISTORIES') || [],\r\n    }\r\n  },\r\n  components: {\r\n    SearchHistory,\r\n    SearchResult,\r\n    SearchSuggestion,\r\n  },\r\n  methods: {\r\n    onCancel() {\r\n      // this.$router.back()\r\n      console.log('取消')\r\n    },\r\n    onSearch(val) {\r\n      console.log(val)\r\n      // 更新文本框内容\r\n      this.value = val\r\n      // 存储历史记录，不能有重复记录，最新的排在最前面\r\n      // array.indexof（val）,如果找到即！== -1，则移除对应项\r\n      // array.unshift\r\n      const index = this.searchHistories.indexOf(val)\r\n      if (index !== -1) {\r\n        // 有重复值\r\n        // splice删除\r\n        this.searchHistories.splice(index, 1)\r\n      }\r\n      // 向前插入值\r\n      this.searchHistories.unshift(val)\r\n      // 渲染搜索结果\r\n      this.isShowResult = true\r\n    },\r\n  },\r\n  watch: {\r\n    searchHistories(val) {\r\n      // 最新的数组传入\r\n      setItem('TOUTIAO_SEARCH_HISTORIES', val)\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.search-container {\r\n  padding-top: 108px;\r\n  .serach-form {\r\n    position: fixed;\r\n    top: 0;\r\n    right: 0;\r\n    left: 0;\r\n    z-index: 1;\r\n    .van-search__action {\r\n      color: #fff;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}