{"ast":null,"code":"import CellList from '@/components/CellList';\nimport { getChannelsApi } from '@/api/user.js';\nimport ChannelEdit from './components/ChannelEdit';\nimport { mapState } from 'vuex';\nimport { getItem } from '@/utils/storage';\nexport default {\n  data() {\n    return {\n      active: 0,\n      tablist: [],\n      //频道列表\n      isShowPop: false\n    };\n  },\n  components: {\n    CellList,\n    ChannelEdit\n  },\n  computed: {\n    ...mapState(['user'])\n  },\n  methods: {\n    // 获取tab标签\n    async getChannels() {\n      try {\n        // 登录状态：直接请求用户数据\n        let channels = [];\n        if (this.user) {\n          const {\n            data: res\n          } = await getChannelsApi();\n          channels = res.data.channels;\n          // console.log(res.data)\n        } else {\n          // 未登录状态：\n          // 1：有本地存储，读取本地存储\n          if (getItem('TOUTIAO_CHANNELS')) {\n            channels = getItem('TOUTIAO_CHANNELS');\n          } else {\n            // 2：无本地存储，请求匿名用户数据\n            const {\n              data: res\n            } = await getChannelsApi();\n            channels = res.data.channels;\n          }\n        }\n        this.tablist = channels;\n      } catch (error) {\n        console.log('请求失败');\n      }\n    },\n    // 改变激活tab标签\n    changeActive(value, isShowPop) {\n      this.active = value;\n      // console.log(value)\n      // 关闭pop弹层\n      this.isShowPop = isShowPop;\n    },\n    changeEditState() {\n      this.$refs.ChannelEditID.isEdit = false;\n    }\n  },\n  created() {\n    this.getChannels();\n  }\n};","map":{"version":3,"mappings":"AA0DA;AACA;AACA;AACA;AACA;AACA;EACAA;IACA;MACAC;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;EACA;EACAC;IACA;IACA;MACA;QACA;QACA;QACA;UACA;YAAAR;UAAA;UACAS;UACA;QACA;UACA;UACA;UACA;YACAA;UACA;YACA;YACA;cAAAT;YAAA;YACAS;UACA;QACA;QACA;MACA;QACAC;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACA;EACA;AACA","names":["data","active","tablist","isShowPop","components","CellList","ChannelEdit","computed","methods","channels","console","changeActive","changeEditState","created"],"sourceRoot":"src/views/Home","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div class=\"home-wrap\">\r\n    <!-- navbar导航栏 -->\r\n    <div>\r\n      <van-nav-bar class=\"page-nav-bar\" fixed>\r\n        <template #title>\r\n          <van-button type=\"info\" icon=\"search\" round block> 搜索 </van-button>\r\n        </template>\r\n      </van-nav-bar>\r\n    </div>\r\n\r\n    <!-- tab选项卡 -->\r\n    <div class=\"tabs-wrap\">\r\n      <!-- 汉堡 按钮  -->\r\n      <div class=\"hangber-btn\">\r\n        <van-button\r\n          icon=\"gengduo\"\r\n          icon-prefix=\"toutiao\"\r\n          @click=\"isShowPop = true\"></van-button>\r\n      </div>\r\n      <van-tabs\r\n        line-width=\"20px\"\r\n        color=\"#3296fa\"\r\n        v-model=\"active\"\r\n        :swipeable=\"true\"\r\n        :border=\"true\"\r\n        :swipe-threshold=\"4\">\r\n        <van-tab\r\n          v-for=\"item in tablist\"\r\n          :title=\"item.name\"\r\n          :key=\"item.id\"\r\n          title-class=\"vantab-class\">\r\n          <CellList :channel=\"item\" />\r\n        </van-tab>\r\n      </van-tabs>\r\n    </div>\r\n\r\n    <!-- pop弹出层 -->\r\n\r\n    <van-popup\r\n      v-model=\"isShowPop\"\r\n      position=\"bottom\"\r\n      :style=\"{ height: '100%' }\"\r\n      closeable\r\n      close-icon-position=\"top-left\"\r\n      round\r\n      @close=\"changeEditState\">\r\n      <!-- 自定义组件 ChannelEdit-->\r\n      <ChannelEdit\r\n        :channels=\"tablist\"\r\n        :activeId=\"active\"\r\n        @changeActiveFn=\"changeActive\"\r\n        ref=\"ChannelEditID\" />\r\n    </van-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CellList from '@/components/CellList'\r\nimport { getChannelsApi } from '@/api/user.js'\r\nimport ChannelEdit from './components/ChannelEdit'\r\nimport { mapState } from 'vuex'\r\nimport { getItem } from '@/utils/storage'\r\nexport default {\r\n  data() {\r\n    return {\r\n      active: 0,\r\n      tablist: [], //频道列表\r\n      isShowPop: false,\r\n    }\r\n  },\r\n  components: {\r\n    CellList,\r\n    ChannelEdit,\r\n  },\r\n  computed: {\r\n    ...mapState(['user']),\r\n  },\r\n  methods: {\r\n    // 获取tab标签\r\n    async getChannels() {\r\n      try {\r\n        // 登录状态：直接请求用户数据\r\n        let channels = []\r\n        if (this.user) {\r\n          const { data: res } = await getChannelsApi()\r\n          channels = res.data.channels\r\n          // console.log(res.data)\r\n        } else {\r\n          // 未登录状态：\r\n          // 1：有本地存储，读取本地存储\r\n          if (getItem('TOUTIAO_CHANNELS')) {\r\n            channels = getItem('TOUTIAO_CHANNELS')\r\n          } else {\r\n            // 2：无本地存储，请求匿名用户数据\r\n            const { data: res } = await getChannelsApi()\r\n            channels = res.data.channels\r\n          }\r\n        }\r\n        this.tablist = channels\r\n      } catch (error) {\r\n        console.log('请求失败')\r\n      }\r\n    },\r\n    // 改变激活tab标签\r\n    changeActive(value, isShowPop) {\r\n      this.active = value\r\n      // console.log(value)\r\n      // 关闭pop弹层\r\n      this.isShowPop = isShowPop\r\n    },\r\n    changeEditState() {\r\n      this.$refs.ChannelEditID.isEdit = false\r\n    },\r\n  },\r\n  created() {\r\n    this.getChannels()\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.page-nav-bar {\r\n  .van-button {\r\n    height: 66px;\r\n    width: 400px;\r\n    background-color: #52a7fc;\r\n    border: 0;\r\n    .van-icon {\r\n      color: #fff;\r\n    }\r\n  }\r\n}\r\n.tabs-wrap::v-deep {\r\n  padding-top: 178px;\r\n  padding-bottom: 100px;\r\n  box-sizing: border-box;\r\n  .van-tabs__content {\r\n    min-height: 800px;\r\n  }\r\n  .van-tabs--line {\r\n    .van-tabs__wrap {\r\n      height: 86px;\r\n      position: fixed;\r\n      left: 0px;\r\n      right: 0px;\r\n      top: 92px;\r\n      z-index: 9;\r\n    }\r\n  }\r\n  .van-tabs__nav {\r\n    padding: 0px;\r\n    .van-tabs__line {\r\n      bottom: 10px;\r\n    }\r\n  }\r\n  .hangber-btn {\r\n    position: fixed;\r\n    z-index: 10;\r\n    right: 0px;\r\n    top: 92px;\r\n    height: 84px;\r\n    background: rgba(255, 255, 255, 0.9) url('~@/assets/gradient-gray-line.png')\r\n      no-repeat left center;\r\n    background-size: contain;\r\n    padding-left: 2px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    .van-button {\r\n      height: 84px;\r\n      border: 0px;\r\n      width: 64px;\r\n      background-color: transparent;\r\n      .toutiao-gengduo {\r\n        font-size: 28px;\r\n      }\r\n    }\r\n  }\r\n}\r\n.pop-wrap {\r\n  position: relative;\r\n}\r\n</style>\r\n<style lang=\"less\">\r\n.vantab-class {\r\n  border: 1px solid rgb(243, 243, 243);\r\n  min-width: 190px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}